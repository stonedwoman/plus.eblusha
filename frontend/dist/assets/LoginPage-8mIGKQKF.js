import{r as c,u as m,j as s}from"./vendor-query-D8-W16Rz.js";import{u as p,a as l,b as d,c as x}from"./index-BsoneBeU.js";import"./vendor-react-DyfnzrEv.js";import"./vendor-socket-CA1CrNgP.js";import"./vendor-crypto-C7xP7Q7Y.js";function S(){const n=p(e=>e.setSession);l();const a=d(),[o,i]=c.useState(null),r=m({mutationFn:async e=>(await x.post("/auth/login",e)).data,onSuccess:e=>{n({user:e.user,accessToken:e.accessToken});const t=a.state?.from?.pathname??"/";setTimeout(()=>{window.location.replace(t)},0)},onError:()=>{i("Неверные данные")}}),u=e=>{e.preventDefault();const t=new FormData(e.currentTarget);r.mutate({username:String(t.get("username")??""),password:String(t.get("password")??"")})};return s.jsxs("form",{className:"auth-form",onSubmit:u,children:[s.jsx("h2",{children:"Вход"}),s.jsxs("label",{children:["Логин",s.jsx("input",{name:"username",type:"text",required:!0,autoComplete:"username"})]}),s.jsxs("label",{children:["Пароль",s.jsx("input",{name:"password",type:"password",required:!0,autoComplete:"current-password"})]}),o?s.jsx("div",{className:"auth-error",children:o}):null,s.jsx("button",{type:"submit",disabled:r.isPending,children:r.isPending?"Входим…":"Войти"})]})}export{S as default};
